<div class="row">
    <div class="col-xl-4">
        <div class="row">
            <div class="col-xl-12">
                <div class="card">
                    <div class="card-body">
                        <div class="profile-statistics">
                            <div class="text-center">
                                <div class="row">
                                    <div class="col">
                                        <h3 class="m-b-0">{{ supplyRequest.price}}</h3><span>Offer Price</span>
                                    </div>
                                    <div class="col">
                                        <h3 class="m-b-0">{{SupplyOffer.length}}</h3><span>Supplier engagement</span>
                                    </div>
                                   <!--  <div class="col">
                                        <h3 class="m-b-0">45</h3><span>Reviews</span>
                                    </div> -->
                                </div>
                                <div class="mt-4">
                                  
                                    <a  class="btn btn-primary mb-1"  (click)="updateSupplier(supplyRequest.id)">Update request</a>
                                </div>
                            </div>
                            <!-- Modal -->
                            <div class="modal fade" id="sendMessageModal" >
                                <div class="modal-dialog modal-dialog-centered" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Send Message</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>
                                        <div class="modal-body">
                                            <form [formGroup]="messageForm" >
                                                <div class="row"> 
                                                    <div class="col-lg-6">
                                                        <div class="mb-3">
                                                          
                                                            <label class="text-black font-w600 form-label"> Suggest a Supply Request Offer Price <span class="required">*</span></label>
                                                            <input type="number" formControlName="SuggestedPrice" placeholder="Enter price">
                                                        </div>
                                                    </div>
                                                 
                                                    <div class="col-lg-12">
                                                        <div class="mb-3 mb-0">
                                                          
                                                            <button type="submit"  class="submit btn btn-primary" data-bs-dismiss="modal" (click)="sendSuggestionPrice()"> send price</button>
                                                        </div>
                                                        
                                                    </div>
                                                    
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-12">
                <div class="card">
                    <div class="card-header">
                        <h4 class="card-title">Suppliers Offers</h4>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="custom-table">
                                <thead>
                                    <tr>
                                      
                                        <th> <h2>Supplier name</h2></th>
                                    
                                        <th><h2>Price</h2></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let item of SupplyOffer">
                                       
                                        <td> <h5>{{item.supplier.nom}}</h5></td>
                                       
                                        <td class="color-primary"><h5>{{item.price}}</h5></td>
                                    </tr>
                                   
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
          
           <!--  <div class="col-xl-12">
                <div class="card">
                    <div class="card-body">
                        <div class="profile-news">
                            <h5 class="text-primary d-inline">Our Latest News</h5>
                            <div class="media pt-3 pb-3">
                                <img src="images/profile/5.jpg" alt="image" class="me-3 rounded" width="75">
                                <div class="media-body">
                                    <h5 class="m-b-5"><a href="post-details.html" class="text-black">Double Cheese Margherita</a></h5>
                                    <p class="mb-0">I shared this on my fb wall a few months back, and I thought.</p>
                                </div>
                            </div>
                            <div class="media pt-3 pb-3">
                                <img src="images/profile/6.jpg" alt="image" class="me-3 rounded" width="75">
                                <div class="media-body">
                                    <h5 class="m-b-5"><a href="post-details.html" class="text-black">Double Cheese Margherita</a></h5>
                                    <p class="mb-0">I shared this on my fb wall a few months back, and I thought.</p>
                                </div>
                            </div>
                            <div class="media pt-3 pb-3">
                                <img src="images/profile/7.jpg" alt="image" class="me-3 rounded" width="75">
                                <div class="media-body">
                                    <h5 class="m-b-5"><a href="post-details.html" class="text-black">Double Cheese Margherita</a></h5>
                                    <p class="mb-0">I shared this on my fb wall a few months back, and I thought.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->
        </div>
    </div>
    <div class="col-xl-8">
        <div class="card">
            <div class="card-body">
                <div class="post-details">
                    <h3 class="mb-2 text-black">{{supplyRequest.productname}}</h3>
                    <ul class="mb-4 post-meta d-flex flex-wrap">
                        <li class="post-author me-3">By Admin</li>
                        <li class="post-date me-3"><i class="fas fa-calendar-check me-2"></i>{{supplyRequest.createdAt}}</li>
                        <!-- <li class="post-comment"><i class="fas fa-comment me-2"></i>28</li> -->
                    </ul>
                    <img src="images/profile/8.jpg" alt="" class="img-fluid mb-3 w-100 rounded">
                    <h1>Product Image :</h1>
                    <div class="circle-container">
                      <img class="circle-image" [src]="supplyRequest.image.imageUrl" alt="Your Image">
                    </div>
                    <h1>Product description :</h1>
                    
                     <h3>{{supplyRequest.requirement}}</h3> 
                <br>
                <br>
                <br>
                   <h4>number of offers : {{SupplyOffer.length}}</h4>
                    <div class="card">
                        <div class="card-header d-block">
                            <h4 class="card-title">Suppliers Offers</h4>
                           
                        </div>
                        <div class="card-body">
                            
                            <div class="accordion accordion-danger-solid" id="accordion-two">
                                <div class="accordion-item" *ngFor="let item of SupplyOffer; let i = index">
                                  <div class="accordion-header collapsed rounded-lg"
                                       id="accord-{{i}}"
                                       data-bs-toggle="collapse"
                                       [attr.data-bs-target]="'#collapse2' + i"
                                       [attr.aria-controls]="'collapse2' + i"
                                       aria-expanded="false"
                                       role="button">
                                    <span class="accordion-header-text">{{ item.supplier.nom }}</span>
                                    <span class="accordion-header-indicator"></span>
                                  </div>
                                  <div [id]="'collapse2' + i" class="collapse accordion__body " [attr.aria-labelledby]="'accord-' + i" data-bs-parent="#accordion-two">
                                    <div class="row">
                                        <div class="col-md-9"> <!-- Text column -->
                                    <div class="accordion-body-text">
                                         <h3 class="subtitle"> Supplier Phone Number:</h3> 
                                        <h4 class="data">{{ item.supplier.numeroTelephone }}</h4>
                                        <h3 class="subtitle"> Supplier Description:</h3> 
                                        <h4 class="data">{{ item.description }}</h4>
                                        <h3 class="subtitle"> Supplier Offer Price:</h3> 
                                        <h4 class="data">{{ item.price }}</h4>
                                        <h3 class="subtitle"> Original Offer Price:</h3> 
                                        <h4 class="data">{{ supplyRequest.price }}</h4>
                                       
                                        <ng-container *ngIf="((item.price - supplyRequest.price) / supplyRequest.price * 100) > 0">
                                            <!-- Your content goes here -->
                                            <h3 class="subtitle"> Increase Percentage:</h3> 
                                            <h4 class="data">{{ (( item.price- supplyRequest.price) / supplyRequest.price * 100).toFixed(2) }}%</h4>
                                          </ng-container>
                                          <ng-container *ngIf="((item.price - supplyRequest.price) / supplyRequest.price * 100) < 0">
                                            <!-- Your content goes here -->
                                            <h3 class="subtitle"> Decrease Percentage:</h3> 
                                            <h4 class="data">{{ (( item.price- supplyRequest.price) / supplyRequest.price * 100).toFixed(2) }}%</h4>
                                          </ng-container>
                                        </div>
                                        <button *ngIf="item.status == 'Pending'" class="btn light btn-success"  style="margin: 5px;" (click)="setStatusAccepted(item.id)">Accept Offer</button>
                                        <button *ngIf="item.status == 'Pending'" class="btn light btn-danger"  style="margin: 5px;" (click)="setStatusRefused(item.id)">Refuse Offer</button>
                                        <h3 *ngIf="item.status == 'Approved'"   style="margin: 5px; color: green;" >Offer Accepted</h3>
                                        <h3 *ngIf="item.status == 'NotApproved'"   style="margin: 5px; color: red;" >Offer Refused</h3>
                                      <!--   <button (click)="addUserToList(item.supplier.id)">Add Chat Template</button> -->
                                    </div>
                                    <div class="col-md-3"> <!-- Image column -->
                                        <img src="https://random.imagecdn.app/1000/1000" alt="Image" class="img-fluid" width="300px" height="300px"> 
                                    </div>
                                        
                                      </div>
                                  </div>
                                </div>
                              </div>
                              
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div  class="row" >
  <div class="card">
    <div class="card-body">
    <div class="container" >
        <div class="row no-gutters">
          <div class="col-md-4 border-right" id="chat-container">
            <div class="settings-tray">
              <img class="profile-image" src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/filip.jpg" alt="Profile img">
              <span class="settings-tray--right">
                <i class="material-icons">cached</i>
                <i class="material-icons">message</i>
                <i class="material-icons">menu</i>
              </span>
            </div>
            <div class="search-box">
              <div class="input-wrapper">
                <i class="material-icons">search</i>
                <input placeholder="Search here" type="text" [(ngModel)]="searchTerm">
              </div>
            </div>
            <ng-container *ngFor="let receiver of filteredUsersList" >
            <div class="friend-drawer friend-drawer--onhover" (click)="loadConversation(userID,receiver.id)">
              <img class="profile-image" src="../../assets/images/companylogo.jpg" alt="">
              <div class="text">
                <h6>{{receiver.nom}}</h6>
                <!--  <p class="text-muted">Last Message: {{ lastMessage.content}}</p> -->  <!-- this should contain getLastMessage() function -->
              </div>
              <span class="time text-muted small">13:21</span> <!-- this should contain lastCreatedFunction() and from base function -->
              <span class="time text-muted small">{{receiver.numeroTelephone}}</span>
            </div>
            <hr>
             </ng-container>
          </div>
          
          <div class="col-md-8" *ngIf="showChat">
            <div class="settings-tray">
                <div class="friend-drawer no-gutters friend-drawer--grey">
                <img class="profile-image" src="../../assets/images/companylogo.jpg" alt="">
                <div class="text">
                  <h6>Supplier company X</h6>
                  <p class="text-muted">Chat with supplier</p>
                </div>
                <span class="settings-tray--right">
                  <i class="material-icons">cached</i>
                  <i class="material-icons">message</i>
                  <i class="material-icons">menu</i>
                </span>
              </div>
            </div>
            <div class="chat-panel" >
                <div class="chat-messages" id="style-13">
                <div class="row no-gutters" *ngFor="let message of messages">
                    <div class="col-md-3" [ngClass]="{'offset-md-9': message.senderFK == this.userID}">
                      <div class="chat-bubble" [ngClass]="{'chat-bubble--right': message.senderFK === this.userID, 'chat-bubble--left': message.senderFK !== ReceiverId}">
                        <span *ngIf="message.isButton === 0">{{ message.content }}</span>
                        <!-- Display the button if the message is a button -->
                        
                      </div>
                      <button *ngIf="message.isButton === 1" class ="btn btn-primary" (click)="handleButtonClick()">
                        - Price: {{ messageForm.value.price }} {{ message.content }} 
                    </button>
                    </div>
                  </div>
             <!--  <div class="row no-gutters">
                <div class="col-md-3 offset-md-9">
                  <div class="chat-bubble chat-bubble--right">
                    Hello dude!
                  </div>
                </div>
              </div>
              <div class="row no-gutters">
                <div class="col-md-3 offset-md-9">
                  <div class="chat-bubble chat-bubble--right">
                    Hello dude!
                  </div>
                </div>
              </div>
              <div class="row no-gutters">
                <div class="col-md-3">
                  <div class="chat-bubble chat-bubble--left">
                    Hello dude!
                  </div>
                </div>
              </div>
              <div class="row no-gutters">
                <div class="col-md-3">
                  <div class="chat-bubble chat-bubble--left">
                    Hello dude!
                  </div>
                </div>
              </div>
              <div class="row no-gutters">
                <div class="col-md-3">
                  <div class="chat-bubble chat-bubble--left">
                    Hello dude!
                  </div>
                </div>
              </div>
              <div class="row no-gutters">
                <div class="col-md-3 offset-md-9">
                  <div class="chat-bubble chat-bubble--right">
                    Hello dude!
                  </div>
                </div>
              </div> -->
            </div>
              <div class="row">
                <div class="col-12">
                  <div class="chat-box-tray">
                    
                    <input [(ngModel)]="newMessage" type="text" placeholder="Type your message here...">
                    <i class="material-icons" style="cursor: pointer;" (click)="sendMessage()">send</i>
                   
                  </div>
                </div>
              </div>
            </div>
            <a  class="btn btn-primary mb-1" data-bs-toggle="modal" data-bs-target="#sendMessageModal">Suggest Change Offer Price</a>
          </div>
        </div>
      </div>
      </div>
      </div>

</div>